function update(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}if(validationForm(e)&&emailSearch(e.email,e.code.value)&&cpfSearch(e.cpf,e.code.value)){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=$("#"+e.id).serialize();$.post(n+"/users/controller/update",o,(function(e){var n=e.split("->");"1"===n[0]?t.fire({icon:"success",title:" "+n[1]}):"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]})}))}}function updateDepartment(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}if(validationForm(e)){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=$("#"+e.id).serialize();$.post(n+"/users/controller/department/update",o,(function(e){var n=e.split("->");"1"===n[0]?t.fire({icon:"success",title:" "+n[1]}):"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]})}))}}function updateStatus(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}if(validationForm(e)){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=$("#"+e.id).serialize();$.post(n+"/users/controller/status",o,(function(e){var n=e.split("->");if("1"===n[0]){t.fire({icon:"success",title:" "+n[1]});var o=document.getElementById("status"),i=o.children[o.selectedIndex].textContent;document.getElementById("tr-status").innerHTML=i,location.reload()}else"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]});$("#modal-status").modal("hide")}))}}function updatePrivileges(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}if(validationForm(e)){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=$("#"+e.id).serialize();$.post(n+"/users/controller/privilege/update",o,(function(e){var n=e.split("->");if("1"===n[0]){t.fire({icon:"success",title:" "+n[1]});var o=document.getElementById("privileges"),i=o.children[o.selectedIndex].textContent;document.getElementById("tr-privileges").innerHTML=i,location.reload()}else"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]});$("#modal-privileges").modal("hide")}))}}function updateAgent(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}if(validationForm(e)){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=$("#"+e.id).serialize();$.post(n+"/users/controller/agent/update",o,(function(e){var n=e.split("->");"1"===n[0]?(t.fire({icon:"success",title:" "+n[1]}),location.reload()):"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]}),$("#modal-agent").modal("hide")}))}}function emailSearch(e,t){var n=!0;if(emailValidation(e)){if(document.querySelector("#dir_site")){var o=document.querySelector("#dir_site"),i="";null!==o.value&&""!==o.value&&(i="/"+o.value)}var a="email="+e.value;""!==t&&null!==t&&(a+="&code="+t);var l=e.id;$.post(i+"/users/search/search_email",a,(function(t){"1"===t?(e.classList.add("is-invalid"),document.getElementById("to_validation_already_registered_"+l).style.display="block",document.getElementById("to_validation_blank_"+l).style.display="none",n=!1):(e.classList.remove("is-invalid"),document.getElementById("to_validation_already_registered_"+l).style.display="none",document.getElementById("to_validation_blank_"+l).style.display="none",n=!0)}))}else document.getElementById("to_validation_already_registered_"+l).style.display="none";return n}function cpfSearch(e,t){var n=!0;if(cpfValidate(e)){if(document.querySelector("#dir_site")){var o=document.querySelector("#dir_site"),i="";null!==o.value&&""!==o.value&&(i="/"+o.value)}var a="cpf="+e.value;""!==t&&null!==t&&(a+="&code="+t);var l=e.id;$.post(i+"/users/search/search_cpf",a,(function(t){"1"===t?(e.classList.add("is-invalid"),document.getElementById("to_validation_already_registered_"+l).style.display="block",document.getElementById("to_validation_blank_"+l).style.display="none",n=!1):(e.classList.remove("is-invalid"),document.getElementById("to_validation_already_registered_"+l).style.display="none",document.getElementById("to_validation_blank_"+l).style.display="none",n=!0)}))}else{l=e.id;document.getElementById("to_validation_already_registered_"+l).style.display="none"}return n}function recoveryPasswd(e){if(document.querySelector("#dir_site")){var t=document.querySelector("#dir_site"),n="";null!==t.value&&""!==t.value&&(n="/"+t.value)}swal.fire({title:recoveryTitle,text:recoveryText,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:recoveryButton}).then((t=>{if(t.isConfirmed){const t=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o="code="+e;$.post(n+"/users/controller/passwd",o,(function(e){var n=e.split("->");"1"===n[0]?t.fire({icon:"success",title:" "+n[1]}):"2"===n[0]&&t.fire({icon:"warning",title:" "+n[1]})}))}}))}function loadOccupation(){if(document.querySelector("#dir_site")){var e=document.querySelector("#dir_site"),t="";null!==e.value&&""!==e.value&&(t="/"+e.value)}var n;edit="#ocuppation_div",n=document.getElementById("department");var o="";$(edit).html("");var i=n.options[n.selectedIndex].value;null!==i&&""!==i&&(o="code="+i);var a=o;$.post(t+"/occupations/search/occupations",a,(function(e){$(edit).html(e)}))}function loadOccupations(e,t){if(document.querySelector("#dir_site")){var n=document.querySelector("#dir_site"),o="";null!==n.value&&""!==n.value&&(o="/"+n.value)}var i="code="+e+"&occupation="+t;$.post(o+"/occupations/search/occupations",i,(function(e){$("#ocuppation_div").html(e)}))}function displayShowForm(){document.getElementById("show_departments").style.display="block"}function displayHideForm(){document.getElementById("show_departments").style.display="none"}function displayDepartments(){"1"===document.getElementById("agent_status").value?displayShowForm():displayHideForm()}function userPhotoSave(){if(document.querySelector("#dir_site")){var e=document.querySelector("#dir_site"),t="";null!==e.value&&""!==e.value&&(t="/"+e.value)}const n=swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3});var o=document.getElementById("form_photo_user"),i=new FormData(o);$.ajax({url:t+"/users/controller/photo",type:"POST",enctype:"multipart/form-data",data:i,processData:!1,contentType:!1,success:function(e){var t=e.split("->");"1"===t[0]?(n.fire({icon:"success",title:" "+t[1]}),document.location.reload(!0)):"1"!==t[0]&&n.fire({icon:"warning",title:" "+t[1]})}})}function readURL(e){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){document.getElementById("div_modal_user_img").style.display="block",document.getElementById("div_modal_user_i_div").style.display="none",$("#div_modal_user_img").attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}function uploadPhoto(){$("#user_photo").trigger("click")}function cleanFormPhoto(){document.getElementById("div_modal_user_img").style.display="none",document.getElementById("div_modal_user_i_div").style.display="block",$("#div_modal_user_img").attr("src",""),$("#user_photo").attr("value","")}$(document).ready((function(){$(".data").datepicker();var e=document.getElementById("site_locale").value;Inputmask(masks[e]).mask(".data"),$("#contact").inputmask("(99) 99999-9999",{placeholder:"(##) #####-####"}),cpfFormat(document.getElementById("cpf"))})),$(document).ready((function(){$("#user_photo").on("change",(function(){readURL(this)}))}));const btnUploadPhoto=document.getElementById("div-upload-user-photo");btnUploadPhoto.addEventListener("click",(function(){uploadPhoto()}));const btnCleanFormPhoto=document.getElementById("btn-clean-form-photo");btnCleanFormPhoto.addEventListener("click",(function(){cleanFormPhoto()}));const btnSavePhoto=document.getElementById("btn-save-photo");btnSavePhoto.addEventListener("click",(function(){userPhotoSave()}));const btnUpdateStatus=document.getElementById("btn-update-status");btnUpdateStatus.addEventListener("click",(function(){updateStatus(edit_status)}));const btnUpdatePrivileges=document.getElementById("btn-update-privileges");btnUpdatePrivileges.addEventListener("click",(function(){updatePrivileges(edit_privileges)}));const btnUpdateAgent=document.getElementById("btn-update-agent");btnUpdateAgent.addEventListener("click",(function(){updateAgent(edit_agent)}));